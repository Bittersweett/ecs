# 重置Linux弹性云服务器的密码<a name="ZH-CN_TOPIC_0021427650"></a>

## 前提条件<a name="section35515688202027"></a>

-   已经准备一台Linux操作系统的临时弹性云服务器，且该临时弹性云服务器与待重置密码的弹性云服务器位于同一个可用区。
-   临时弹性云服务器已经绑定弹性公网IP。

## 操作步骤<a name="section9546131644416"></a>

1.  下载重置密码的脚本，并上传至临时弹性云服务器。
    1.  登录管理控制台，选择“计算 \> 弹性云服务器”。
    2.  <a name="li264061615441"></a>在需要重置密码的弹性云服务器（即原弹性云服务器）的“操作”列下，单击“更多 \> 重置密码”。

        系统打开“重置密码”弹窗。单击蓝色的“重置密码脚本”字样，下载脚本，如[图1](#fig12640141664411)所示。

        **图 1**  下载重置密码脚本<a name="fig12640141664411"></a>  
        ![](figures/下载重置密码脚本.png "下载重置密码脚本")

        您可以在桌面左下角，查看到下载的重置密码脚本。

    3.  在本地通过WinSCP等连接工具，将[1.b](#li264061615441)中获取的changepasswd.sh脚本上传到临时云服务器。

        WinSCP下载地址：[http://winscp.net/](http://winscp.net/)。


2.  <a name="li19814359584"></a>关闭原弹性云服务器，卸载其系统盘，并将系统盘挂载到临时弹性云服务器。
    1.  原弹性云服务器关机，进入详情页，并选择“云硬盘”页签。

        >![](public_sys-resources/icon-note.gif) **说明：**   
        >原弹性云服务器关机时，请勿执行强制关机操作，否则可能引起重置密码操作失败。  

    2.  <a name="li5640121684418"></a>单击系统盘所在行的“卸载”，卸载该系统盘。
    3.  展开临时弹性云服务器的详情页，并选择“云硬盘”页签。
    4.  单击“挂载磁盘”，在“挂载磁盘”对话框中，选择[2.b](#li5640121684418)中卸载的系统盘，将其挂载到临时弹性云服务器上。

3.  远程登录临时弹性云服务器，并重置密码。
    1.  在临时弹性云服务器的“操作”列下，单击“远程登录”。
    2.  <a name="li664021617445"></a>执行以下命令，查看原弹性云服务器上卸载的系统盘在临时弹性云服务器上的目录。

        **fdisk -l**

    3.  在脚本所在目录执行以下命令，运行重置密码脚本。

        **chmod +x changepasswd.sh**

        **./changepasswd.sh**

        运行重置密码脚本时，如果系统提示没有lv相关的命令（如no lvs commmand），则需要在临时弹性云服务器安装lvm\(Logical Volume Manager\)工具，推荐使用lvm2，您可以执行命令**yum install lvm2**进行安装。

        >![](public_sys-resources/icon-notice.gif) **注意：**   
        >如果原弹性云服务器和临时弹性云服务器的操作系统均为centos7，运行脚本过程中可能会出现挂载失败。请将脚本中的内容“mount $dev $mountPath”修改为“mount -o nouuid $dev $mountPath”，避免脚本运行失败。  

    4.  根据系统提示输入新设置的密码和[3.b](#li664021617445)中获取到的目录信息。

        系统显示如下回显信息时，说明密码设置成功。

        ```
        set password success.
        ```


4.  关闭临时弹性云服务器，卸载原弹性云服务器的系统盘，并将其重新挂载回原弹性云服务器后执行重启操作。
    1.  临时弹性云服务器关机，并进入详情页，选择“云硬盘”页签。
    2.  <a name="li964031614447"></a>单击“卸载”，卸载[2](#li19814359584)中临时挂载的数据盘。
    3.  展开原Linux弹性云服务器的详情页，选择“云硬盘”页签。
    4.  单击“挂载磁盘”，在“挂载磁盘”对话框中，选择[4.b](#li964031614447)中卸载的数据盘，并设置挂载点为“/dev/sda”。
    5.  重启原弹性云服务器。


